<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title></title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <!-- Place favicon.ico and apple-touch-icon.png in the root directory -->

            <!--<link rel="stylesheet" href="css/bootstrap.min.css" type="text/css"> -->
    <link href="jquery-mobile/jquery.mobile.theme-1.3.0.min.css" rel="stylesheet" type="text/css">
    <link href="jquery-mobile/jquery.mobile.structure-1.3.0.min.css" rel="stylesheet" type="text/css">
        <script src="js/vendor/modernizr-2.6.2.min.js"></script>
    </head>
<body>
        <!--[if lt IE 7]>
            <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
        <![endif]-->

        <!-- Add your site or application content here -->
	<div>
        <form role="form" id="main-form">
            <div id="accordion">
                <div data-role="page" id="home-page">
                    <div data-role="header" data-position="fixed">
                        <h1>Accident Information Form</h1>
                    </div>
                    <div data-role="content">
                        <ul data-role="listview" data-inset="true">
                            <li><a href="#personal">Your Personal Information</a></li>
                            <li><a href="#vehicle">Your Vehicle Information</a></li>
                            <li><a href="#insurance">Insurance Information</a></li>
                            <li><a href="#accident">Accident Information</a></li>
                            <li><a href="#other_vehicles">Other Drivers/Vehicles</a></li>
                            <li><a href="#witness">Witness Information</a></li>
                            <li><a href="#police">Police Information</a></li>
                        </ul>
                    </div>
                    <div data-role="content">
                        <ul data-role="listview" data-inset="true">
                            <li><a href="#photo">Upload Photos</a></li>
                            <li><a href="#note">Additional Notes</a></li>
                        </ul>
                    </div>
                    <button  data-icon="forward" data-mini="true" type="submit" id="submit-btn">Submit</button>
                </div><!-- end home-page -->
    <fieldset id="accident" data-role="page">
    <div data-role="header" data-position="fixed">
        <a href="#home-page" data-icon="back" class="save-button">Save</a>
        <h1>Accident Information</h1>
    </div>
    <div data-role="content">
          <div>
                    <label for="acc_date">Date: </label>
                    <div>
                        <input type="date" name="acc_date" id="acc_date" required />
                    </div>
                </div>
                <div>
                    <label for="acc_time">Time: </label>
                    <div><input type="time" name="acc_time" id="acc_time" required /></div>
                </div>
                <div>
                    <label for="acc_weather">Weather: </label>
                    <div><input type="text" name="acc_weather" id="acc_weather" /></div>
                </div>
                <div>
                    <label for="acc_loc">Location: </label>
                    <div><input type="text" name="acc_loc" id="acc_loc" required /><button type="button" onclick="getLocation();">Locate Me</button</div>
                </div>
                <div>
                    <label for="acc_desc">Description: </label>
                    <div><textarea name="acc_desc" id="acc_desc" required></textarea></div>
                </div>
    </div>
  </fieldset><!-- end #accident -->
  <fieldset id="other_vehicles" data-role="page">
    <div data-role="header" data-position="fixed">
        <a href="#home-page" data-icon="back" class="save-button">Save</a>
        <h1>Other Vehicles</h1>
    </div>
      <div data-role="content">
                <h4>Other Person's Information</h4>
                <div>
                    <label for="other_name">Name</label>
                    <div><input name="other_name" id="other_name" /></div>
                </div><!-- end .form-group --> 
                <div>
                    <label for="other_add">Address</label>
                    <div><input name="other_add" id="other_add" /></div>
                </div><!-- end .form-group --> 
                <div>
                    <label>Phone</label>
                    <div><input name="other_phone" id="other_phone" /></div>
                </div><!-- end .form-group -->
                <div>
                    <label for="other_email">Email</label>
                    <div><input name="other_email" type="email"/></div>
                </div><!-- end .form-group -->
                <div>
                    <label for="other_lic">License</label>
                    <div><input type="text" name="other_lic" /></div>
                </div><!-- end .form-group -->   
                <div>
                    <label for="other_com">Comments</label>
                    <div><textarea name="other_com"></textarea></div>
                </div><!-- end .form-group --> 
                <h4>Insurance Information</h4>
                <div>
                    <label for="other_ins">Company</label>
                    <div><input type="text" name="other_ins"/></div>
                </div><!-- end .form-group --> 
                <div>
                    <label for="other_policy">Policy Number</label>
                    <div><input type="text" name="other_policy"/></div>
                </div><!-- end .form-group --> 
                <div>
                    <label for="other_num">Phone Number</label>
                    <div><input type="tel" name="other_num"/></div>
                </div><!-- end .form-group --> 
          
      </div>
  </fieldset><!-- end #other_vehicles -->
                <fieldset id="witness" data-role="page">
                    <div data-role="header" data-position="fixed">
                        <a href="#home-page" data-icon="back" class="save-button">Save</a>
                        <h1>Witness Information</h1>
                    </div>
                        <div data-role="content">
                            <h4>Witness 1</h4>
                            <div>
                            <label for="wit_1_name">Name</label>
                            <div><input type="text" name="wit_1_name"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                            <label for="wit_1_phone">Phone</label>
                            <div><input type="tel" name="wit_1_phone"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                            <label for="wit_1_com">Comments</label>
                            <div><textarea name="wit_1_com"></textarea></div>
                            </div><!-- end .form-group --> 
                            <h4>Witness 2</h4>
                            <div>
                            <label for="wit_2_name">Name</label>
                            <div><input type="text" name="wit_2_name" /></div>
                            </div><!-- end .form-group --> 
                            <div>
                            <label for="wit_2_phone">Phone</label>
                            <div><input type="tel" name="wit_2_phone" /></div>
                            </div><!-- end .form-group --> 
                            <div>
                            <label for="wit_2_com">Comments</label>
                            <div><textarea name="wit_2_com"></textarea></div>
                            </div><!-- end .form-group --> 
                            <h4>Witness 3</h4>
                            <div>
                            <label for="wit_3_name">Name</label>
                            <div><input type="text" name="wit_3_name"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                            <label for="wit_3_phone">Phone</label>
                            <div><input type="tel" name="wit_3_phone"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                            <label for="wit_3_com">Comments</label>
                            <div><textarea name="wit_3_com"></textarea></div>
                            </div><!-- end .form-group -->                    
                    </div>
                </fieldset><!-- end #witness -->
                <fieldset id="police" data-role="page">
                    <div data-role="header" data-position="fixed">
                        <a href="#home-page" data-icon="back" class="save-button">Save</a>
                        <h1>Police Information</h1>
                    </div>
                        <div data-role="content">
                            <div>
                                <label for="case_num">Case Number</label>
                                <div><input type="text" name="case_num"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                                <label for="officer">Officer's Name</label>
                                <div><input type="text" name="officer"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                                <label for="badge">Badge Number</label>
                                <div><input type="text" name="badge"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                                <label for="phonenumber">Phone</label>
                                <div><input type="tel" name="policenumber" /></div>
                            </div><!-- end .form-group --> 
                        
                        </div>
                </fieldset><!-- end #police -->
                <fieldset id="personal" data-role="page">
                    <div data-role="header" data-position="fixed">
                        <a href="#home-page" data-icon="back" class="save-button">Save</a>
                        <h1>Your Information</h1>
                    </div>
                        <div data-role="content">
                            <div>
                                <label for="client_name">Name</label>
                                <div  ><input type="text" name="client_name" required/></div>
                            </div><!-- end .form-group --> 
                            <div  >
                                <label for="client_add">Address</label>
                                <div  ><input type="text" name="client_add" required /></div>
                            </div><!-- end .form-group --> 
                            <div  >
                                <label for="client_city">City/State</label>
                                <div  ><input type="text" name="client_city" required/></div>
                            </div><!-- end .form-group --> 
                            <div  >
                                <label for="client_phone">Phone</label>
                                <div  ><input type="tel"  name="client_phone" required/></div>
                            </div><!-- end .form-group --> 
                            <div  >
                                <label for="client_email">Email</label>
                                <div  ><input type="email" name="client_email" required/></div>
                            </div><!-- end .form-group -->
                            </div>
                </fieldset><!-- end #personal -->
                <fieldset id="insurance" data-role="page">
                    <div data-role="header" data-position="fixed">
                        <a href="#home-page" data-icon="back" class="save-button">Save</a>
                        <h1>Insurance Information</h1>
                    </div>
                        <div data-role="content">
                            <div>
                                <label for="ins_name">Insurance Company</label>
                                <div><input type="text" name="ins_name"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                                <label for="ins_phone">Insurance Phone Number</label>
                                <div><input type="tel" name="ins_phone"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                                <label for="ins_policy">Policy Number</label>
                                <div><input type="text" name="ins_policy"/></div>
                            </div><!-- end .form-group --> 
                            <div>
                                <label for="ins_claim">Claim Number</label>
                                <div><input type="text" name="ins_claim" /></div>
                            </div><!-- end .form-group --> 
                        
                        </div>
                </fieldset><!-- end #insurance -->
                <fieldset id="vehicle" data-role="page">
                    <div data-role="header" data-position="fixed">
                        <a href="#home-page" data-icon="back" class="save-button">Save</a>
                        <h1>Vehicle Information</h1>
                    </div>
                        <div data-role="content">
                            <div>
                                <label for="car_year">Year</label>
                                <div><input name="car_year" id="car_year" type="text" /></div>
                            </div><!-- end .form-group --> 
                            <div>
                                <label for="car_make">Make</label>
                                <div  ><input name="car_make" type="text" id="car_make" /></div>
                            </div><!-- end .form-group --> 
                            <div  >
                                <label for="car_model">Model</label>
                                <div  ><input name="car_model" id="car_model" type="text" /></div>
                            </div><!-- end .form-group --> 
                            <div  >
                                <label for="car_plate">License Plate</label>
                                <div  ><input name="car_plate" id="car_plate" type="text"  /></div>
                            </div><!-- end .form-group --> 
                            <div  >
                                <label for="car_vin">VIN #</label>
                                <div  ><input name="car_vin" id="car_vin" type="text" /></div>
                            </div><!-- end .form-group --> 
                            <div  >
                                <label for="car_color">Color</label>
                                <div  ><input name="car_color" id="car_color" type="text"/></div>
                            </div><!-- end .form-group --> 
                    </div>
                </fieldset><!-- end #vehicle -->
                <fieldset id="photo" data-role="page">
                    <div data-role="header" data-position="fixed">
                        <a href="#home-page" data-icon="back" class="save-button">Save</a>
                        <h1>Photos for Evidence</h1>
                    </div>
                    <div data-role="content">
                        <div>
                            <div><button type="button" onclick="capturePhoto();">Capture Photo</button></div>
                            <img id="image1" />
                        </div><!-- end .form-group --> 
                        <div  >
                            <div><button type="button" onclick="getPhoto(pictureSource.PHOTOLIBRARY);">Upload Photo</button></div>
                        </div><!-- end .form-group --> 
                        <div id="photo-holder"></div>
                    </div>
                </fieldset><!-- end #photo -->
                <fieldset data-role="page" id="note">
                    <div data-role="header" data-position="fixed">
                        <a href="#home-page" data-icon="back" class="save-button">Save</a>
                        <h1>Additional Notes</h1>
                    </div>
                        <div data-role="content">
                            <div  >
                                <div  ><textarea name="client_notes"></textarea></div>
                </div><!-- end .form-group --> 
                        </div>
                </fieldset><!-- end #notes -->
</div>
        </form>
    </div>
        <script src="js/vendor/jquery-1.10.2.min.js" type="text/javascript"></script>
        <script src="jquery-mobile/jquery.mobile-1.3.0.min.js" type="text/javascript"></script>
        <script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.13.0/jquery.validate.min.js" type="text/javascript"></script>
        <!--<script src="js/bootstrap.min.js"></script>-->
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript">
            var userData = {};
            userData.photos = [];
            var numPhotos;
            var pictureSource;
            var destinationType;
            
            document.addEventListener("deviceready", onDeviceReady, false);
            
            function onDeviceReady() {
                pictureSource = navigator.camera.PictureSourceType;
                destinationType = navigator.camera.DestinationType;
            }
            
            function onPhotoURISuccess(imageURI) {
                userData.photos[userData.photos.length] = imageURI;
            }
            
            function capturePhoto() {
                alert("Capturing Photo");
                navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50 });
            }
            
            function getPhoto(source) {
                // Retrieve image file location from specified source
                navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50, 
                destinationType: destinationType.FILE_URI,
                sourceType: source });
            }
            
            function onFail(message) {
                alert('Failed because: ' + message);
            }
            
            function parseForm(formName) {
                $.each($(formName).serializeArray(), function(i, field) {
                    userData[this.name] = field.value;
                });
            }
            
            $("#main-form").submit(function(event) {
                event.preventDefault();
                // alert("submit successful");
                parseForm(this);
                //$.each(userData, function(key, value) {
                //    if (value != '') {
                //    console.log(key + ": " + value);
                //    }
                //});
                window.plugin.email.open({
                    to:         ['andymeyer747@gmail.com'],
                    subject:    'Success!',
                    body:       
                                'Client Name: ' + userData.client_name + '\n' +
                                'Client Address: ' + userData.client_add + '\n' +
                                'Client City: ' + userData.client_city + '\n' +
                                'Client Phone Number: ' + userData.client_phone + '\n' +
                                'Client Email: ' + userData.client_email + '\n \n' + 
                                'Client Vehicle Information Year: ' + userData.car_year + '\n' +
                                'Client Vehicle Make: ' + userData.car_make + '\n' +
                                'Client Vehicle Model: ' + userData.car_model + '\n' +
                                'Client License Plate: ' + userData.car_plate + '\n' +
                                'Client VIN: ' + userData.car_vin + '\n' +
                                'Client Vehicle Color: ' + userData.car_color + '\n' +
                                'Client Insurance Information: \n' +
                                'Client Insurance Company: ' + userData.ins_name + '\n' +
                                'Client Insurance Phone Number: ' + userData.ins_phone + '\n' +
                                'Client Insurance Policy Number: ' + userData.ins_policy + '\n' +
                                'Client Insurance Claim Number: ' + userData.ins_claim + '\n \n' +
                                'Accident Date: ' + userData.acc_date + '\n' +
                                'Accident Time: ' + userData.acc_time + '\n' +
                                'Accident Weather: ' + userData.acc_weather + '\n' +
                                'Accident Location: ' + userData.acc_loc +'\n' +
                                'Accident Description: ' + userData.acc_desc + '\n \n' +
                                'Other Person\'s Information: \nName: ' + userData.other_name + '\n' +
                                'Address: ' + userData.other_add + '\n' +
                                'Phone Number: ' + userData.other_phone + '\n' +
                                'Email: ' + userData.other_email + '\n' +
                                'License Number: ' + userData.other_lic +'\n' +
                                'Comments: ' + userData.other_com + '\n' +
                                'Insurance Company: ' + userData.other_ins + '\n' +
                                'Insurance Policy: ' + userData.other_policy + '\n' +
                                'Insurance Phone Number: ' +  userData.other_num + '\n \n' +
                                'Witness 1 Name: ' + userData.wit_1_name + '\n' +
                                'Witness 1 Phone: ' + userData.wit_1_phone + '\n' +
                                'Witness 1 Comments: ' + userData.wit_1_com + '\n \n' +
                                'Witness 2 Name: ' + userData.wit_2_name + '\n' +
                                'Witness 2 Phone: ' + userData.wit_2_phone + '\n' +
                                'Witness 2 Comments: ' + userData.wit_2_com + '\n \n' +
                                'Witness 3 Name: ' + userData.wit_3_name + '\n' +
                                'Witness 3 Phone: ' + userData.wit_3_phone + '\n' +
                                'Witness 3 Comments: ' + userData.wit_3_com + '\n \n' + 'Police Case Number: ' + userData.case_num + '\n' +
                                'Police Officer\'s Name: ' + userData.officer + '\n' +
                                'Badge Number: ' + userData.badge + '\n' +
                                'Police Phone Number: ' + userData.policenumber + '\n' +
                                'Client Notes: ' + userData.client_notes,
                    attachments: userData.photos
                    }
                );
            });
            
            function getLocation() {
                navigator.geolocation.getCurrentPosition(onLocationSuccess, onLocationError);
            }
            
            function onLocationSuccess(position) {
                $("#acc_loc").val(position.coords.latitude.toString() + " " + position.coords.longitude.toString());
            }
            
            function onLocationError() {
                alert("Could not find current location.  Please enter manually");
            }
        </script>
        <!-- Google Analytics: change UA-XXXXX-X to be your site's ID. -->
        <script>
            (function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-XXXXX-X');ga('send','pageview');
        </script>
</body>
</html>
